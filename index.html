<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>HTS ‚Äî Password ‚Üí Finger ‚Üí Flipbook ‚Üí GIF ‚Üí Video ‚Üí End</title>

<!-- =========================
     NOTE:
     - Flipbook code is included exactly as you sent it (not modified).
     - I only added modal/pop-up structure and orchestration around it.
     - Replace ASSET URLs below if needed.
   ========================= -->

<style>
  /* ====== Modal + common styles (fade in/out center) ====== */
  :root{
    --cream-a:#fbf5ec; --cream-b:#f3eadc; --accent:#c69c71; --muted:#4b3d33; --popup-radius:16px;
  }
  .modal {
    position: fixed;
    left:50%;
    top:50%;
    transform: translate(-50%,-50%) scale(.98);
    z-index: 9999;
    min-width: 300px;
    max-width: 92vw;
    padding: 18px;
    border-radius: var(--popup-radius);
    box-shadow: 0 24px 60px rgba(0,0,0,0.15);
    background: linear-gradient(180deg,var(--cream-a),var(--cream-b));
    display: none;
    opacity: 0;
    transition: opacity .32s, transform .32s;
    text-align:center;
    color: var(--muted);
    font-family: 'Poppins', system-ui, Arial;
  }
  .modal.show { display:block; opacity:1; transform: translate(-50%,-50%) scale(1); }
  .modal h3 { margin:6px 0 10px; font-size:20px; }
  .modal p { margin:0 0 12px; }
  .modal .buttons { display:flex; gap:10px; justify-content:center; margin-top:8px; }
  .btn { background:var(--accent); border:none; padding:10px 16px; border-radius:12px; color:white; font-weight:700; cursor:pointer; }
  input[type=password], input[type=text] { width:100%; padding:12px; border-radius:12px; border:1px solid rgba(0,0,0,0.06); background:transparent; font-size:15px; }

  /* small fingerprint UI */
  .finger-area{display:flex;align-items:center;flex-direction:column;gap:12px}
  .finger-btn{width:92px;height:92px;border-radius:50%;background:linear-gradient(180deg,rgba(0,0,0,0.06),rgba(0,0,0,0.03));display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:34px}
  .finger-progress{width:86px;height:8px;background:rgba(0,0,0,0.06);border-radius:20px;overflow:hidden}
  .finger-progress>i{display:block;height:100%;width:0%;background:linear-gradient(90deg,#d2ad88,#b78c6b);transition:width .06s linear}

  /* GIF / video container sizing */
  .media-wrap { width:320px;height:200px; display:flex; align-items:center; justify-content:center; }
  .video-wrap { width:420px;height:260px; display:flex; align-items:center; justify-content:center; }

  /* center-stage overlay to host the flipbook container; ensures modals sit above it */
  #overlayStage {
    position: fixed;
    inset: 0;
    z-index: 100;
    display:flex; align-items:center; justify-content:center;
    pointer-events: none; /* allow modals to capture clicks */
  }

  /* hide the original book until unlocked */
  #book { display: none; pointer-events: auto; } /* we'll show it after fingerprint */

  /* small helper to dim background when modal active */
  .backdrop {
    position: fixed; inset:0; background: rgba(0,0,0,0.04); z-index: 50; display:none; opacity:0; transition:opacity .25s;
  }
  .backdrop.show { display:block; opacity:1; }

  /* music control (small) */
  .music { position: fixed; left:14px; bottom:14px; z-index: 9999; background: linear-gradient(180deg, rgba(255,255,255,0.96), rgba(250,245,238,0.96)); padding:10px 14px; border-radius:14px; box-shadow:0 12px 36px rgba(0,0,0,0.12); display:flex; gap:10px; align-items:center; font-family:'Poppins'; }
  .music input[type=range]{ width:140px; }

  /* keep balloon z-index low so modals appear above */
  .balloon { z-index: 20; pointer-events:none; }

  /* responsive tweak for modal max width */
  @media (max-width:900px){
    .modal { max-width: 94vw; }
  }
</style>

<!-- ========== Below: YOUR ORIGINAL FLIPBOOK CODE (kept exactly, unchanged) ========== -->
<style>
  /* your flipbook's styles (kept exactly as you sent) */
  body {
    background-color: #f9f3e9;
    font-family: 'Poppins', sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    overflow: hidden;
  }

  .book {
    width: 320px;
    height: 420px;
    position: relative;
    perspective: 1500px;
  }

  .page {
    width: 100%;
    height: 100%;
    background: #fffaf5;
    color: #444;
    border-radius: 10px;
    box-shadow: 0 0 15px rgba(0,0,0,0.1);
    position: absolute;
    top: 0;
    left: 0;
    transform-origin: left;
    transition: transform 1s, z-index 0.5s;
    backface-visibility: hidden;
    padding: 30px;
    box-sizing: border-box;
    z-index: 10;
  }

  .page.flipped {
    transform: rotateY(-180deg);
    z-index: 0;
  }

  .page h2 {
    text-align: center;
    font-size: 18px;
    margin-top: 40%;
  }

  button {
    position: absolute;
    bottom: -60px;
    background: #cfa47c;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 10px;
    cursor: pointer;
    font-size: 14px;
  }

  #prev { left: 0; }
  #next { right: 0; }

  .balloon {
    position: absolute;
    border-radius: 50%;
    opacity: 0.7;
    animation: float 6s ease-in-out infinite;
  }

  @keyframes float {
    0% { transform: translateY(0); }
    50% { transform: translateY(-20px); }
    100% { transform: translateY(0); }
  }

  .b1 { width: 70px; height: 90px; background: #f8a5c2; top: 10%; left: 10%; animation-delay: 0s; }
  .b2 { width: 80px; height: 100px; background: #74b9ff; top: 30%; left: 25%; animation-delay: 1s; }
  .b3 { width: 60px; height: 80px; background: #ffeaa7; top: 20%; right: 20%; animation-delay: 2s; }
  .b4 { width: 70px; height: 90px; background: #55efc4; bottom: 20%; left: 15%; animation-delay: 3s; }
  .b5 { width: 80px; height: 100px; background: #fab1a0; bottom: 15%; right: 25%; animation-delay: 4s; }
</style>

</head>
<body>

<!-- backdrop dim -->
<div id="backdrop" class="backdrop"></div>

<!-- MODALS (centered, fade in/out) -->
<div id="pwdModal" class="modal show" aria-modal="true">
  <h3>Masukkan sandi</h3>
  <p>Masukkan kata sandi untuk membuka.</p>
  <input id="pwdInput" type="password" placeholder="ketik sandi">
  <div class="buttons"><button id="pwdNext" class="btn">Next</button></div>
</div>

<div id="pwdWrong" class="modal" aria-modal="true">
  <h3>Kata sandi salah</h3>
  <p>Silakan coba lagi.</p>
  <div class="buttons"><button id="pwdRetry" class="btn">Coba lagi</button></div>
</div>

<div id="fingerModal" class="modal" aria-modal="true">
  <h3>Verifikasi Sidik Jari</h3>
  <p>Tahan tombol sidik jari beberapa detik untuk melanjutkan.</p>
  <div class="finger-area">
    <div class="finger-btn" id="fingerBtn">üîí</div>
    <div class="finger-progress"><i id="fingerFill"></i></div>
  </div>
</div>

<div id="gifModal" class="modal" aria-modal="true">
  <div class="media-wrap"><img id="gifImg" src="" style="max-width:100%;max-height:100%"></div>
</div>

<div id="videoModal" class="modal" aria-modal="true">
  <div class="video-wrap"><video id="floatVideo" src="" controls style="max-width:100%;max-height:100%"></video></div>
</div>

<div id="endModal" class="modal" aria-modal="true">
  <h3>Penutup</h3>
  <p id="endText">Terima kasih ‚Äî ganti teks di EDITABLE VARIABLES.</p>
  <div class="buttons"><button id="endClose" class="btn">Tutup</button></div>
</div>

<!-- music control -->
<div class="music" style="pointer-events:auto;">
  <button id="playBtn" class="btn">Play</button>
  <div style="font-size:14px">Music: <span id="musicLabel">[ganti di script]</span></div>
  <input id="vol" type="range" min="0" max="1" step="0.01" value="0.6">
  <audio id="bgMusic" loop preload="auto" src=""></audio>
</div>

<!-- Balloons (kept from your flipbook) -->
<div class="balloon b1" style="left:6%;"></div>
<div class="balloon b2" style="left:22%;"></div>
<div class="balloon b3" style="left:38%;"></div>
<div class="balloon b4" style="left:56%;"></div>
<div class="balloon b5" style="left:78%;"></div>

<!-- overlay stage hosts the original flipbook markup (unchanged) -->
<div id="overlayStage">
  <!-- ========== ORIGINAL FLIPBOOK MARKUP (kept exactly) ========== -->
  <div class="book" id="book">
    <div class="page"><h2>Halaman 1 ‚Äî Hai, ini halaman pertama üíå</h2></div>
    <div class="page"><h2>Halaman 2 ‚Äî Makasih udah buka buku ini ü§ç</h2></div>
    <div class="page"><h2>Halaman 3 ‚Äî Setiap lembar punya arti sendiri...</h2></div>
    <div class="page"><h2>Halaman 4 ‚Äî Nanti kamu isi sendiri yaa~</h2></div>
    <div class="page"><h2>Halaman 5 ‚Äî üå∑</h2></div>
    <div class="page"><h2>Halaman 6</h2></div>
    <div class="page"><h2>Halaman 7</h2></div>
    <div class="page"><h2>Halaman 8</h2></div>
    <div class="page"><h2>Halaman 9</h2></div>
    <div class="page"><h2>Halaman 10 ‚Äî Terakhir üí´</h2></div>

    <button id="prev">Prev</button>
    <button id="next">Next</button>
  </div>
  <!-- ========== END ORIGINAL FLIPBOOK MARKUP ========== -->
</div>

<!-- ================== SCRIPTS: orchestration (password -> fingerprint -> show flipbook -> proceed after last page) ================== -->
<script>
/* ===== EDITABLE VARIABLES =====
   Ganti asset URLs jika perlu.
*/
const PASSWORD = 'arjingga25';
const MUSIC_LABEL = 'Sempurna (ganti)';
const MUSIC_SRC = '';    // isi link mp3 kamu
const GIF_SRC = '';      // isi gif link nanti
const VIDEO_SRC = '';    // isi video link nanti (mp4/webm) or leave empty for placeholder timing
const END_TEXT = 'Terima kasih ‚Äî ganti teks di EDITABLE VARIABLES';
/* ===== END EDITABLE ===== */

/* modal helpers */
const backdrop = document.getElementById('backdrop');
function showModal(id){
  document.getElementById(id).classList.add('show');
  backdrop.classList.add('show');
}
function hideModal(id){
  document.getElementById(id).classList.remove('show');
  // if no other modal shown, hide backdrop
  const any = document.querySelectorAll('.modal.show');
  if(any.length === 0) backdrop.classList.remove('show');
}

/* ---------- PASSWORD FLOW ---------- */
const pwdInput = document.getElementById('pwdInput');
document.getElementById('pwdNext').addEventListener('click', checkPwd);
pwdInput.addEventListener('keydown', e => { if(e.key === 'Enter') checkPwd(); });
function checkPwd(){
  if(pwdInput.value === PASSWORD){
    hideModal('pwdModal');
    setTimeout(()=> showModal('fingerModal'), 260);
  } else {
    hideModal('pwdModal');
    showModal('pwdWrong');
  }
}
document.getElementById('pwdRetry').addEventListener('click', ()=>{ hideModal('pwdWrong'); showModal('pwdModal'); pwdInput.value=''; pwdInput.focus(); });

/* ---------- FINGERPRINT (hold) ---------- */
const fingerBtn = document.getElementById('fingerBtn');
const fingerFill = document.getElementById('fingerFill');
let fillInt=null, fill=0;
function fingerStart(){ fill=0; fingerFill.style.width='0%'; fillInt=setInterval(()=>{ fill+=4; fingerFill.style.width = fill+'%'; if(fill>=100){ fingerComplete(); } },90); }
function fingerStop(){ clearInterval(fillInt); fingerFill.style.width='0%'; }
function fingerComplete(){ clearInterval(fillInt); fingerFill.style.width='100%'; hideModal('fingerModal'); setTimeout(showFlipbook, 350); }
fingerBtn.addEventListener('mousedown', fingerStart);
fingerBtn.addEventListener('touchstart', fingerStart);
document.addEventListener('mouseup', fingerStop);
document.addEventListener('touchend', fingerStop);

/* ---------- SHOW FLIPBOOK (once fingerprint OK) ---------- */
const book = document.getElementById('book');
const nextBtn = document.getElementById('next');
const prevBtn = document.getElementById('prev');

function showFlipbook(){
  // reveal the book (the flipbook markup + style is exactly as you had it)
  book.style.display = 'block';
  // focus on Next button for keyboard
  try{ nextBtn.focus(); }catch(e){}
  // ensure we reset any progress just in case
  current = 0;
  // hide any open modals/backdrop
  const open = document.querySelectorAll('.modal.show');
  open.forEach(m => m.classList.remove('show'));
  backdrop.classList.remove('show');
}

/* ====== The flipbook logic below is EXACTLY your code (unchanged) ====== */
const pages = document.querySelectorAll('.page');
let current = 0;

// set z-index ordering (this was in your script)
pages.forEach((page, index) => {
  page.style.zIndex = pages.length - index;
});

// next/prev behavior (your code)
nextBtn.addEventListener('click', () => {
  if (current < pages.length) {
    pages[current].classList.add('flipped');
    current++;
    checkIfFinished();
  }
});

prevBtn.addEventListener('click', () => {
  if (current > 0) {
    current--;
    pages[current].classList.remove('flipped');
  }
});

/* helper to check when finished (after showing all pages) */
let proceeded = false;
function checkIfFinished(){
  // when current equals pages.length, user reached beyond last page
  if(!proceeded && current >= pages.length){
    proceeded = true;
    // small delay so last page flip finishes visually
    setTimeout(()=> { proceedAfterBook(); }, 700);
  }
}

/* ---------- proceedAfterBook: GIF -> VIDEO -> END ---------- */
function proceedAfterBook(){
  // show gif modal (if GIF_SRC empty still show short placeholder)
  if(GIF_SRC && GIF_SRC.trim() !== ''){
    document.getElementById('gifImg').src = GIF_SRC;
    showModal('gifModal');
    setTimeout(()=>{ hideModal('gifModal'); setTimeout(showVideoModal, 300); }, 2000);
  } else {
    // short pause then video
    setTimeout(showVideoModal, 500);
  }
}

function showVideoModal(){
  if(VIDEO_SRC && VIDEO_SRC.trim() !== ''){
    document.getElementById('floatVideo').src = VIDEO_SRC;
    showModal('videoModal');
    // when video ends -> show end modal
    const v = document.getElementById('floatVideo');
    v.play().catch(()=>{});
    v.onended = ()=>{ hideModal('videoModal'); setTimeout(()=> showEndModal(), 300); };
  } else {
    // if no video, show end modal after a short delay
    setTimeout(()=> showEndModal(), 1000);
  }
}

function showEndModal(){
  document.getElementById('endText').textContent = END_TEXT;
  showModal('endModal');
}

/* close end modal */
document.getElementById('endClose').addEventListener('click', ()=>{ hideModal('endModal'); });

/* ---------- Music controls ---------- */
const audio = document.getElementById('bgMusic');
const playBtn = document.getElementById('playBtn');
const vol = document.getElementById('vol');
document.getElementById('musicLabel').textContent = MUSIC_LABEL;
if(MUSIC_SRC) audio.src = MUSIC_SRC;
playBtn.addEventListener('click', ()=>{
  if(audio.paused){ audio.play().catch(()=>{}); playBtn.textContent='Pause'; } else { audio.pause(); playBtn.textContent='Play'; }
});
vol.addEventListener('input',(e)=>{ if(audio) audio.volume = e.target.value; });
if(audio) audio.volume = vol.value;

/* ---------- Keyboard navigation ---------- */
document.addEventListener('keydown', (e)=>{
  try{
    if(e.key === 'ArrowRight') nextBtn.click();
    if(e.key === 'ArrowLeft') prevBtn.click();
    if(e.key === 'Escape'){ const open = document.querySelectorAll('.modal.show'); open.forEach(m=>m.classList.remove('show')); backdrop.classList.remove('show'); }
  }catch(err){}
});

/* initial focus & safety: keep book hidden until unlocked */
book.style.display = 'none';
document.getElementById('pwdInput').focus();
document.getElementById('endText').textContent = END_TEXT;

/* ensure fingerprint modal shows after password success - handled in checkPwd above */
</script>
</body>
</html>
